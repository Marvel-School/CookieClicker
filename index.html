<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title id="count">Cookie Clicker</title>
    <link rel="icon" type="image/png" href="image/cookie.png" />
    <!-- Put tooltip.css AFTER styles.css for higher precedence -->
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="tooltip.css" />
    <!-- Add personalization CSS -->
    <link rel="stylesheet" href="personalization.css" />
    <link rel="preload" href="image/cookie.png" as="image" />
    <link rel="preload" href="sounds/click.mp3" as="audio" />

    <style>
      /* Immediately disable all tooltips */
      .item-desc,
      .tooltip,
      [data-tooltip],
      [title] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
      }
    </style>

    <script type="text/javascript">
      // Clean up tooltips after page loads
      document.addEventListener("DOMContentLoaded", function () {
        // Remove all tooltip elements from the DOM
        document
          .querySelectorAll(".item-desc, .tooltip, [data-tooltip]")
          .forEach((tooltip) => {
            if (tooltip.parentNode) tooltip.parentNode.removeChild(tooltip);
          });

        // Prevent tooltip attributes from working
        document.querySelectorAll("[title]").forEach((el) => {
          el.removeAttribute("title");
        });
      });
    </script>
  </head>
  <body>
    <!-- LEFT Section: Upgrade Buttons -->
    <section class="left">
      <div class="button">
        <button
          id="clickUpgrade"
          type="button"
          class="upgrade"
          data-content="Upgrade Click Power (Cost: 10)"
          
        >
          <img class="button_image" src="image/double-tap.png" alt="Click Upgrade" />
          <div class="productContainer">
            <!-- <span class="product"> Click Power</span> -->
           
            <span class="button_top" id="upgradeClick"
              >Upgrade Click Power (Cost: 10)</span
            >
          
        </button>
      </div>

      <div class="button">
        <button
          id="autoClicker"
          type="button"
          class="upgrade"
          data-content="Buy Auto Clicker (Cost: 50)"
        >
          <img class="button_image" src="image/hand.png" alt="Click Upgrade" />
          <div class="productContainer">
            
            <span class="button_top">Buy Auto Clicker (Cost: 50)</span>
          </div>
        </button>
      </div>
      <div class="button">
        <button
          id="grandma"
          type="button"
          class="upgrade"
          data-content="Buy Grandma's Bakery (Cost: 100)"
        >
          <img
            class="button_image"
            src="image/grandma.png"
            alt="Click Upgrade"
          />
          <div class="productContainer">
          
            <span class="button_top">Buy Grandma's Bakery (Cost: 100)</span>
          </div>
        </button>
      </div>
      <div class="button">
        <button
          id="farm"
          type="button"
          class="upgrade"
          data-content="Buy Cookie Farm (Cost: 500)"
        >
          <img class="button_image" src="image/farm.png" alt="Click Upgrade" />
          <div class="productContainer">
           
            <span class="button_top">Buy Cookie Farm (Cost: 500)</span>
          </div>
        </button>
      </div>
      <div class="button">
        <button
          id="luckyClick"
          type="button"
          class="upgrade"
          data-content="Lucky Click (Cost: 20)"
        >
          <img
            class="button_image"
            src="image/goodluck.png"
            alt="Click Upgrade"
          />
          <div class="productContainer">
            
            <span class="button_top">Lucky Click (Cost: 20)</span>
          </div>
        </button>
      </div>
      <!-- Add new building buttons here -->
      <div class="button">
        <button
          id="mine"
          type="button"
          class="upgrade"
          data-content="Buy Cookie Mine (Cost: 3,000)"
        >
          <img
            class="button_image"
            src="image/cookie-mine.png"
            alt="Click Upgrade"
          />
          <div class="productContainer">
            <span class="button_top">Buy Cookie Mine (Cost: 3,000)</span>
          </div>
        </button>
      </div>
      <div class="button">
        <button
          id="factory"
          type="button"
          class="upgrade"
          data-content="Buy Cookie Factory (Cost: 10,000)"
        >
          <img
            class="button_image"
            src="image/cookie-factory.png"
            alt="Click Upgrade"
          />
          <div class="productContainer">
            <span class="button_top">Buy Cookie Factory (Cost: 10,000)</span>
          </div>
        </button>
      </div>
      <div class="button">
        <button
          id="bank"
          type="button"
          class="upgrade"
          data-content="Buy Cookie Bank (Cost: 30,000)"
        >
          <img
            class="button_image"
            src="image/cookie-bank.png"
            alt="Click Upgrade"
          />
          <div class="productContainer">
            <span class="button_top">Buy Cookie Bank (Cost: 30,000)</span>
          </div>
        </button>
      </div>
      <div class="button">
        <button
          id="temple"
          type="button"
          class="upgrade"
          data-content="Buy Cookie Temple (Cost: 100,000)"
        >
          <img
            class="button_image"
            src="image/cookie-temple.png"
            alt="Click Upgrade"
          />
          <div class="productContainer">
            <span class="button_top">Buy Cookie Temple (Cost: 100,000)</span>
          </div>
        </button>
      </div>
    </section>

    <!-- ACHIEVEMENTS Section: Toggled via the Achievements Icon -->
    <div id="achievementsWrapper">
      <img
        id="achievementsIcon"
        src="image/achievements.png"
        alt="Achievements Icon"
        aria-label="Show Achievements"
      />
      <section id="achievementsContainer">
        <div class="achievements-header">
          <span class="trophy-icon">üèÜ</span>
          <h2>Achievements</h2>
        </div>
        <div class="achievements-content">
          <ul id="achievementsList"></ul>
        </div>
      </section>
    </div>

    <!-- SHOP Section: Toggled via the Shop Icon -->
    <div id="shopWrapper">
      <img
        id="shopIcon"
        src="image/shop.png"
        alt="Shop Icon"
        aria-label="Show Shop"
      />
      <section id="shopContainer">
        <div class="shop-header">
          <span class="shop-icon">üõí</span>
          <h2>Shop</h2>
        </div>
        <div class="shop-content">
          <!-- Time Accelerator Shop Item -->
          <div class="shop-item" data-upgrade="timeAccelerator">
            <img
              src="image/timeaccelerator.png"
              alt="Time Accelerator"
              class="shop-item-image"
            />
            <span class="item-cost">Cost: <span>1000</span></span>
            <!-- Simplified tooltip focusing on what the item does -->
            <span class="item-desc">
              <span class="text-highlight">POWER BOOST!</span><br />
              <span class="text-highlight">4x Cookie Production</span><br />
              <span class="text-highlight">for a limited time</span><br />
              <span class="text-highlight">Gets more expensive</span><br />
              <span class="text-highlight">with each purchase</span>
            </span>
            <!-- Countdown timer when active -->
            <span class="time-accelerator-timer"></span>
          </div>

          <!-- Cookie Multiplier Shop Item -->
          <div class="shop-item" data-upgrade="cookieMultiplier">
            <img
              src="image/multiplier.png"
              alt="Cookie Multiplier"
              class="shop-item-image"
            />
            <span class="item-cost">Cost: <span>2000</span></span>
            <span class="item-desc">
              <span class="text-highlight">PERMANENT BOOST!</span><br />
              <span class="text-highlight">Increase cookie</span><br />
              <span class="text-highlight">production by 50%</span><br />
              <span class="text-highlight">Stacks with each</span><br />
              <span class="text-highlight">purchase!</span>
            </span>
          </div>

          <!-- Golden Cookie Charm Shop Item -->
          <div class="shop-item" data-upgrade="goldenCookieChance">
            <img
              src="image/goldencookie.png"
              alt="Golden Cookie Charm"
              class="shop-item-image"
            />
            <span class="item-cost">Cost: <span>3000</span></span>
            <span class="item-desc">
              <span class="text-highlight">LUCKY CHARM!</span><br />
              <span class="text-highlight">Increases chance of</span><br />
              <span class="text-highlight">golden cookies</span><br />
              <span class="text-highlight">Click them for</span><br />
              <span class="text-highlight">random bonuses!</span>
            </span>
          </div>
        </div>
      </section>
    </div>

    <!-- CENTER Section: Background, Stats, and Cookie -->
    <section class="background">
      <!-- Animated Background Decoration -->
      <div class="set">
        <div><img src="image/cookie1.png" alt="decorative cookie" /></div>
        <div><img src="image/cookie3.png" alt="decorative cookie" /></div>
        <div><img src="image/cookie4.png" alt="decorative cookie" /></div>
        <div><img src="image/cookie1.png" alt="decorative cookie" /></div>
      </div>

      <!-- CENTER Section: Background, Stats, and Cookie -->
      <div class="center">
        <div class="stats">
          <h1>
            <span class="cookie-icon">üç™</span>Cookies:
            <span id="cookieCount">0</span>
          </h1>
          <div class="stats-metrics">
            <div class="stats-metric">
              <span class="label">Per Click</span>
              <span class="value"
                ><span class="icon">üëÜ</span
                ><span id="clickPower">1</span></span
              >
            </div>
            <div class="stats-metric">
              <span class="label">Per Second</span>
              <span class="value"
                ><span class="icon">‚è±Ô∏è</span><span id="cps">0</span></span
              >
            </div>
          </div>

          <!-- Add new active bonuses section -->
          <div id="activeBonuses" class="active-bonuses">
            <!-- Active bonuses will be inserted here dynamically -->
          </div>
        </div>
        <img id="cookie" src="image/cookie.png" alt="Cookie" />
      </div>

      <!-- RIGHT Section: Upgrade Visualizations Only -->
      <section class="right">
        <div
          id="autoClickersBox"
          class="upgrade-box"
          data-title="Auto Clickers"
        >
          <div class="upgrade-progress">
            <div
              id="autoClickersProgressBar"
              class="upgrade-progress-bar"
            ></div>
          </div>
          <div class="upgrade-counter">
            <img
              src="image/hand.png"
              alt="Auto Clicker"
              class="upgrade-image"
            />
            <span id="autoClickersCountVisual">0</span>
          </div>
        </div>
        <div id="farmsBox" class="upgrade-box" data-title="Farms">
          <div class="upgrade-progress">
            <div id="farmsProgressBar" class="upgrade-progress-bar"></div>
          </div>
          <div class="upgrade-counter">
            <img src="image/farm.png" alt="Farm" class="upgrade-image" />
            <span id="farmsCountVisual">0</span>
          </div>
        </div>
        <div id="grandmasBox" class="upgrade-box" data-title="Grandmas">
          <div class="upgrade-progress">
            <div id="grandmaProgressBar" class="upgrade-progress-bar"></div>
          </div>
          <div class="upgrade-counter">
            <img src="image/grandma.png" alt="Grandma" class="upgrade-image" />
            <span id="grandmaCount">0</span>
          </div>
        </div>
        <!-- Add new building visualizations in the production section -->
        <div id="minesBox" class="upgrade-box" data-title="Mines">
          <div class="upgrade-progress">
            <div id="mineProgressBar" class="upgrade-progress-bar"></div>
          </div>
          <div class="upgrade-counter">
            <img src="image/cookie-mine.png" alt="Mine" class="upgrade-image" />
            <span id="mineCount">0</span>
          </div>
        </div>
        <div id="factoriesBox" class="upgrade-box" data-title="Factories">
          <div class="upgrade-progress">
            <div id="factoryProgressBar" class="upgrade-progress-bar"></div>
          </div>
          <div class="upgrade-counter">
            <img src="image/cookie-factory.png" alt="Factory" class="upgrade-image" />
            <span id="factoryCount">0</span>
          </div>
        </div>
        <div id="banksBox" class="upgrade-box" data-title="Banks">
          <div class="upgrade-progress">
            <div id="bankProgressBar" class="upgrade-progress-bar"></div>
          </div>
          <div class="upgrade-counter">
            <img src="image/cookie-bank.png" alt="Bank" class="upgrade-image" />
            <span id="bankCount">0</span>
          </div>
        </div>
        <div id="templesBox" class="upgrade-box" data-title="Temples">
          <div class="upgrade-progress">
            <div id="templeProgressBar" class="upgrade-progress-bar"></div>
          </div>
          <div class="upgrade-counter">
            <img src="image/cookie-temple.png" alt="Temple" class="upgrade-image" />
            <span id="templeCount">0</span>
          </div>
        </div>
      </section>

      <!-- SETTINGS Container in Bottom Right -->
      <div id="settingsContainer">
        <button
          id="settingsIcon"
          class="setting-btn"
          aria-label="Toggle Settings"
        >
          <span class="bar bar1"></span>
          <span class="bar bar2"></span>
          <span class="bar bar1"></span>
        </button>
        <div id="settingsMenu" style="display: none">
          <button id="saveGame">Save Game</button>
          <button id="loadGame">Load Game</button>
          <button id="resetGame">Reset Game</button>
          <button id="toggleSound">Toggle Sound</button>
          <button id="personalizationBtn">Personalization</button>
        </div>
      </div>

      <!-- Add Personalization Panel -->
      <div
        id="personalizationContainer"
        class="panel-container"
        style="display: none"
      >
        <div class="panel-header">
          <span class="panel-icon">üé®</span>
          <h2>Personalization</h2>
          <span class="close-btn" id="closePersonalization">√ó</span>
        </div>
        <div class="panel-content">
          <div class="section">
            <h3>Theme</h3>
            <div class="theme-options">
              <button id="theme-classic" class="theme-button">Classic</button>
              <button id="theme-dark" class="theme-button">Dark</button>
              <button id="theme-neon" class="theme-button">Neon</button>
            </div>
          </div>
          <div class="section">
            <h3>Animations</h3>
            <div class="animation-options">
              <button id="animations-standard" class="animation-button">
                Standard
              </button>
              <button id="animations-reduced" class="animation-button">
                Reduced
              </button>
              <button id="animations-minimal" class="animation-button">
                Minimal
              </button>
            </div>
          </div>
          <div class="section">
            <h3>Particle Intensity</h3>
            <input
              type="range"
              id="particle-intensity"
              min="0"
              max="2"
              step="0.1"
              value="1"
            />
            <span id="intensity-value">1.0</span>
          </div>
        </div>
      </div>
    </section>
    <div class="blurz" id="backdrop"></div>
    <!-- Replace the script reference with a module type -->
    <script type="module" src="js/main.js"></script>

    <!-- Comment out the old script reference -->
    <!-- <script src="script.js" defer></script> -->

    <!-- Add this right before the closing body tag -->
    <script>
      // Immediate fix for any backdrop blur
      document.addEventListener('DOMContentLoaded', () => {
        // Fix any elements with backdrop or blur classes
        const blurElements = document.querySelectorAll('#backdrop, .backdrop, .blur, .blurz');
        blurElements.forEach(el => {
          el.style.backdropFilter = 'none';
          el.style.webkitBackdropFilter = 'none';
          el.style.filter = 'none';
          el.classList.remove('blur', 'blurz');
        });
        
        // Add style tag to force override blur
        const styleEl = document.createElement('style');
        styleEl.textContent = `
          #backdrop, .backdrop, .blur, .blurz {
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            filter: none !important;
          }
        `;
        document.head.appendChild(styleEl);
      });
    </script>

    <!-- Add this right before the closing body tag -->
    <script>
      // Check if containers need scroll indicators
      function updateScrollIndicators() {
        const containers = document.querySelectorAll('.left, .right');
        
        containers.forEach(container => {
          // Check if scrollable
          if (container.scrollHeight > container.clientHeight) {
            container.classList.add('has-overflow');
            
            // Add scroll listener if not already added
            if (!container.hasScrollListener) {
              container.addEventListener('scroll', handleScroll);
              container.hasScrollListener = true;
            }
          } else {
            container.classList.remove('has-overflow');
          }
        });
      }
      
      // Handle scroll events to show/hide indicators
      function handleScroll(e) {
        const container = e.target;
        const scrollTop = container.scrollTop;
        const scrollHeight = container.scrollHeight;
        const clientHeight = container.clientHeight;
        
        // Near top
        if (scrollTop < 20) {
          container.classList.add('at-top');
          container.classList.remove('at-bottom');
        } 
        // Near bottom
        else if (scrollTop + clientHeight > scrollHeight - 20) {
          container.classList.add('at-bottom');
          container.classList.remove('at-top');
        } 
        // Middle
        else {
          container.classList.remove('at-top');
          container.classList.remove('at-bottom');
        }
      }
      
      // Run on load and whenever content might change
      window.addEventListener('load', updateScrollIndicators);
      window.addEventListener('resize', updateScrollIndicators);
      
      // Also run occasionally to catch dynamic content changes
      setInterval(updateScrollIndicators, 2000);
    </script>
  </body>
</html>
